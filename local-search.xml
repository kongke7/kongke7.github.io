<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Docker</title>
    <link href="/2023/12/10/Docker/"/>
    <url>/2023/12/10/Docker/</url>
    
    <content type="html"><![CDATA[<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a><u>Docker</u></h1><h2 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h2><h3 id="1-安装docker"><a href="#1-安装docker" class="headerlink" title="1. 安装docker"></a>1. 安装docker</h3><p><strong>进入官方文档</strong>：<a href="https://docs.docker.com/engine/install/centos/">Docker Install</a></p><ul><li>安装之前卸载已有文件</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo yum remove docker \<br>                  docker-client \<br>                  docker-client-latest \<br>                  docker-common \<br>                  docker-latest \<br>                  docker-latest-logrotate \<br>                  docker-logrotate \<br>                  docker-engine<br></code></pre></td></tr></table></figure><ul><li>设置存储库</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo yum install -y yum-utils<br><br><span class="hljs-comment">#注意这里使用国内源</span><br>sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<br></code></pre></td></tr></table></figure><ul><li><p>安装最新版docker引擎</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin<br></code></pre></td></tr></table></figure></li><li><p>启动并验证</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo systemctl start docker<br><br>docker version<br><br><span class="hljs-comment">#测试运行hello-world镜像</span><br>sudo docker run hello-world<br><br><span class="hljs-comment">#查看已有镜像</span><br>docker images<br></code></pre></td></tr></table></figure><h3 id="2-配置阿里云镜像加速器"><a href="#2-配置阿里云镜像加速器" class="headerlink" title="2. 配置阿里云镜像加速器"></a>2. 配置阿里云镜像加速器</h3><p>首先登录阿里云，找到镜像服务 -&gt; 镜像加速器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> -p /etc/docker<br><br><span class="hljs-comment">#注意此处镜像地址用自己阿里云当中的</span><br>sudo <span class="hljs-built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="hljs-string">&#x27;EOF&#x27;</span><br>&#123;<br>  <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<span class="hljs-string">&quot;https://zwx0tf4k.mirror.aliyuncs.com&quot;</span>]<br>&#125;<br>EOF<br><br>systemctl daemon-reload<br><br>systemctl restart docker<br></code></pre></td></tr></table></figure><h2 id="二、常用命令"><a href="#二、常用命令" class="headerlink" title="二、常用命令"></a>二、常用命令</h2><p><strong>详细信息参阅官方文档</strong>：<a href="https://docs.docker.com/reference/">Reference documentation | Docker Docs</a></p><h3 id="1-帮助命令"><a href="#1-帮助命令" class="headerlink" title="1. 帮助命令"></a>1. 帮助命令</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#查看版本信息</span><br>docker version<br><br><span class="hljs-comment">#显示系统信息</span><br>docker info<br><br><span class="hljs-comment">#帮助命令</span><br>docker --<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><h3 id="2-镜像命令"><a href="#2-镜像命令" class="headerlink" title="2. 镜像命令"></a>2. 镜像命令</h3><ul><li><p><code>docker images [选项]</code>：查看本机镜像</p><ul><li><code>-a</code>：列出所有镜像</li><li><code>-q</code>：只显示镜像id</li></ul></li><li><p><code>docker search [选项] 镜像名</code>：搜索镜像</p><ul><li><code>--filter=[条件]</code>：过滤查询</li></ul></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#搜索收藏量大于300的mysql镜像</span><br>docker search mysql --filter=STARS=300<br></code></pre></td></tr></table></figure><ul><li><code>docker pull 镜像名:标签</code>：下载镜像</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#下载mysql镜像</span><br><span class="hljs-comment">#默认下载最新版</span><br>docker pull mysql<br><br><span class="hljs-comment">#下载5.7版本（注：这里的版本需要在镜像仓库中存在）</span><br>docker pull mysql:5.7<br></code></pre></td></tr></table></figure><p>镜像仓库：<a href="https://hub.docker.com/search?q=mysql">Docker Hub | MySQL</a></p><ul><li><code>docker rmi -f [镜像id][][]...</code>：删除指定镜像<ul><li><code>-f $&#123;docker images -q&#125;</code>：删除所有镜像</li></ul></li></ul><h3 id="3-容器命令"><a href="#3-容器命令" class="headerlink" title="3. 容器命令"></a>3. 容器命令</h3><p>有了镜像才能创建容器</p><p>&#x3D;&#x3D;容器相当于在现有镜像上在加一层可写层在镜像顶部&#x3D;&#x3D;</p><ul><li><p><code>docker run [选项] 镜像名</code>：新建容器并启动</p><ul><li><p><code>--name=&quot;名称&quot;</code>：设置容器名称</p></li><li><p><code>-d</code>：后台方式运行</p></li><li><p><code>-it</code>：使用交互方式运行</p></li><li><p><code>-p </code>：指定容器端口</p><ul><li><code>-p ip:主机端口:容器端口</code></li><li><code>-p 主机端口:容器端口</code>：常用</li><li><code>-p 容器端口</code></li><li><code>容器端口</code></li></ul></li><li><p><code>-P</code>：随机指定端口</p></li><li><p><code>-v </code>：容器数据卷挂载目录，数据同步</p><ul><li><p><code>-v 容器内路径</code>：匿名挂载</p></li><li><p><code>-v 卷名:容器内路径</code>：具名挂载</p><blockquote><p>docker中卷都在 <strong><code>/var/lib/docker/volumes</code></strong> 目录中</p><p>可以通过 <strong><code>docker volumes inspect 卷名</code></strong> 查看卷的详细信息</p></blockquote></li><li><p><code>-v 宿主机目录:容器内目录</code>：指定路径挂载</p></li></ul><blockquote><p>容器的持久化和同步操作，将容器内的目录挂载到容器外，使数据同步，容器之间也可以数据共享</p></blockquote></li><li><p><code>--volumes-from 容器id</code>：实现数据同步，链式结构头容器为父容器与宿主机挂载，保证数据不丢失</p></li></ul></li><li><p>限制容器内存</p><p><img src="https://s2.loli.net/2023/12/01/35ZaMPcA1gKDtm7.png" alt="memory"></p><ul><li><p>未启动容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run -m 4g --memory-swap -1  <br></code></pre></td></tr></table></figure></li><li><p>已启动容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker stop containerId<br>docker update containerId -m 4g  --memory-swap -1<br>docker start containerId<br></code></pre></td></tr></table></figure></li></ul><p><strong>注意事项</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">--memory  或  -m  限制容器的内存使用量（如10m,200m等）<br>--memory-swap <span class="hljs-comment"># 限制内存和 Swap 的总和，不设置的话默认为--memory的两倍</span><br><br>如果只指定了 --memory 则 --memory-swap 默认为 --memory 的两倍<br>如果 --memory-swap 和 --memory 设置了相同值，则表示不使用 Swap<br>如果 --memory-swap 设置为 -1 则表示不对容器使用的 Swap 进行限制<br>如果设置了 --memory-swap 参数，则必须设置 --memory 参数<br><br>后期 update --memory 时数值不能超过 --memory-swap 的值，<br>否则会报错 Memory <span class="hljs-built_in">limit</span> should be smaller than already <span class="hljs-built_in">set</span> memoryswap <span class="hljs-built_in">limit</span><br></code></pre></td></tr></table></figure></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 终端交互模式</span><br>docker run -it centos<br><br><span class="hljs-comment"># 后台运行模式</span><br>docker run -d centos <br><br><span class="hljs-comment"># 在挂载卷后加  ro 或 rw 表示指定容器内的目录的权限，ro为只读则容器内该目录只读，默认为rw读写</span><br>docker run -d -v /home/dkh:/home:ro centos<br><br><span class="hljs-comment">#退出容器</span><br><span class="hljs-built_in">exit</span><br><br><span class="hljs-comment">#退出并后台运行</span><br>Ctrl + P + Q<br></code></pre></td></tr></table></figure><ul><li><p><code>docker ps [选项]</code>：查看当前运行的容器</p><ul><li><code>-a</code>：列出所有运行过的容器</li><li><code>-q</code>：只显示容器id</li></ul></li><li><p><code>docker rm [选项] 容器id</code>：删除容器</p><ul><li><code>-f</code>：强制删除</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#删除所有容器</span><br>docker <span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;docker ps -aq&#125;</span><br><br>docker ps -aq | xargs docker <span class="hljs-built_in">rm</span><br></code></pre></td></tr></table></figure></li><li><p><code>docker start 容器id</code>：启动容器</p></li><li><p><code>docker restart 容器id</code>：重启容器</p></li><li><p><code>docker stop 容器id</code>：停止容器</p></li><li><p><code>docker kill 容器id</code>：强制停止容器</p></li><li><p><code>docker commit [选项] 容器id 新镜像名:TAG</code></p><ul><li><code>-a=&quot;作者&quot;</code></li><li><code>-m=&quot;提交信息&quot;</code></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker commit -a=<span class="hljs-string">&quot;kongke&quot;</span> -m=<span class="hljs-string">&quot;设置tomcat主页&quot;</span> tomcat01 tomcat02:1.0<br></code></pre></td></tr></table></figure><blockquote><p>commit指令可以保存当前容器的状态，类似于虚拟机快照，提交变成新的镜像</p></blockquote></li></ul><h3 id="4-其他常用命令"><a href="#4-其他常用命令" class="headerlink" title="4. 其他常用命令"></a>4. 其他常用命令</h3><ul><li><p><code>docker logs [选项] 容器id</code>：查看日志</p><ul><li><code>-tf</code>：显示日志并带上时间戳</li><li><code>--tail 数字</code>：显示日志条数</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#查看该容器的最后5条日志，并监控最新日志</span><br>docker logs -tf --<span class="hljs-built_in">tail</span> 5 aas12sdas<br></code></pre></td></tr></table></figure></li><li><p><code>docker top</code>：查看容器内进程</p></li><li><p><code>docker inspect 容器id</code>：查看容器所有信息(元数据)</p></li><li><p><code>docker exec -it 容器id bashShell</code>：进入正在运行的容器(在容器中开启一个新的终端)</p></li><li><p><code>docker attach 容器id</code>：进入容器正在执行的终端</p></li><li><p><code>docker cp 容器id:容器内路径 目的主机路径</code>：从容器中复制文件到主机上</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">cp</span> 8150473976e6:/home/test.txt /home<br></code></pre></td></tr></table></figure><h2 id="三、常用镜像安装"><a href="#三、常用镜像安装" class="headerlink" title="三、常用镜像安装"></a>三、常用镜像安装</h2><h3 id="1-Nginx安装"><a href="#1-Nginx安装" class="headerlink" title="1. Nginx安装"></a>1. Nginx安装</h3><ul><li><p>搜索nginx镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker search nginx<br></code></pre></td></tr></table></figure></li><li><p>下载</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull nginx<br></code></pre></td></tr></table></figure></li><li><p>启动nginx容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 给镜像命名为nginx01 ，设置端口映射</span><br>docker run -d --name nginx01 -p 3344:80 nginx<br></code></pre></td></tr></table></figure><blockquote><p>注意此处需要打开防火墙3344端口</p></blockquote></li><li><p>查看启动情况</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker ps<br></code></pre></td></tr></table></figure></li><li><p>访问nginx</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">curl localhost:3344<br></code></pre></td></tr></table></figure></li><li><p>进入容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">exec</span> -it nginx01 /bin/bash<br></code></pre></td></tr></table></figure></li></ul><h3 id="2-Tomcat安装"><a href="#2-Tomcat安装" class="headerlink" title="2. Tomcat安装"></a>2. Tomcat安装</h3><ul><li><p>查找并下载tomcat镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull tomcat:9.0<br></code></pre></td></tr></table></figure></li><li><p>启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run -d --name tomcat01 -p 3355:8080 tomcat:9.0<br></code></pre></td></tr></table></figure></li><li><p>进入容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#因为镜像为精简版，运行成功后没有主页，但主页相关文件在webapps.dist中，将其复制到webapps中则可访问</span><br>docker <span class="hljs-built_in">exec</span> tomcat01 /bin/bash<br><br><span class="hljs-built_in">cp</span> -r webapps.dist/* webapps/<br></code></pre></td></tr></table></figure></li><li><p>访问</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> localhost:<span class="hljs-number">3355</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="3-ElasticSearch安装"><a href="#3-ElasticSearch安装" class="headerlink" title="3. ElasticSearch安装"></a>3. ElasticSearch安装</h3><ul><li><p>查找并下载</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull elasticsearch:7.6.2<br></code></pre></td></tr></table></figure></li><li><p>配置容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run -d --name es01 -p 9200:9200 -p 9300:9300 \<br><span class="hljs-comment"># 设置集群模式</span><br>-e <span class="hljs-string">&quot;discovery.type=single-node&quot;</span> \<br><span class="hljs-comment"># 限制内存</span><br>-e ES_JAVA_OPTS=<span class="hljs-string">&quot;-Xms64 -Xmx512m&quot;</span> \<br>elasticsearch:7.6.2<br></code></pre></td></tr></table></figure></li><li><p>访问</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">curl localhost:9200<br></code></pre></td></tr></table></figure></li><li><p>查看内存占用情况</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker stats<br></code></pre></td></tr></table></figure></li></ul><h3 id="4-Mysql安装"><a href="#4-Mysql安装" class="headerlink" title="4. Mysql安装"></a>4. Mysql安装</h3><blockquote><p>mysql安装需要保证数据同步</p></blockquote><ul><li><p>查找并下载镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull mysql:5.7<br></code></pre></td></tr></table></figure></li><li><p>启动并配置镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run -d \<br>-p 3307:3306 \<br><span class="hljs-comment"># 此处为数据卷挂载</span><br>-v /home/dkmysql/conf:/etc/mysql/conf.d \<br>-v /home/dkmysql/data:/var/lib/mysql \<br><span class="hljs-comment"># 设置mysql的密码</span><br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name mysql01 \<br>mysql:5.7<br></code></pre></td></tr></table></figure></li><li><p>利用三方软件登录测试</p></li></ul><h2 id="四、DockerFile"><a href="#四、DockerFile" class="headerlink" title="四、DockerFile"></a>四、DockerFile</h2><blockquote><p>DockerFile 就是用来构建 docker 镜像的<strong>命令脚本</strong></p></blockquote><h3 id="1-DockerFile指令"><a href="#1-DockerFile指令" class="headerlink" title="1. DockerFile指令"></a>1. DockerFile指令</h3><p><strong>常用指令</strong>：</p><ul><li><code>FROM</code>：指定基础镜像</li><li><code>MAINTAINER</code>：备注镜像作者 姓名+邮箱</li><li><code>RUN</code>：构建是需要执行的命令</li><li><code>ADD</code>：添加文件到镜像内，例如：压缩包</li><li><code>WORKDIR</code>：镜像的工作目录</li><li><code>VOLUME</code>：挂载的目录</li><li><code>EXPOSE</code>：暴露的端口</li><li><code>CMD</code>：容器启动时需要运行的命令，只有最后一个会生效，会被覆盖</li><li><code>ENTRYPOINT</code>：容器启动时需要运行的命令，命令可以追加</li><li><code>ONBUILD</code>：当构建一个被继承 DockerFile 时 会触发onbuild的指令</li><li><code>COPY</code>：类似ADD 将文件复制到镜像中</li><li><code>ENV</code>：构建时配置环境变量</li></ul><blockquote><p>CMD 与 ENTRYPOINT 的区别对比</p></blockquote><p><strong>测试CMD</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 在cmd中，执行构建好的镜像时，不能追加命令，只能覆盖命令</span><br>] vim dkfile-cmd<br><br>FROM centos:7<br>CMD [<span class="hljs-string">&quot;ls&quot;</span>,<span class="hljs-string">&quot;-a&quot;</span>]<br><br>] docker build -f dkfile-cmd -t cmdtest .<br><span class="hljs-comment"># 此时如果在指令后追加指令例如入下想达到 ls -al的功能则会报错</span><br>] docker run cmdtest -l<br><span class="hljs-comment">#此处报错称 -l 不是命令，因为此处 -l 会覆盖掉dkfile-cmd中最后一个cmd的命令 【ls -a】</span><br><br><span class="hljs-comment">#但如果将命令写为</span><br>] docker run cmdtest <span class="hljs-built_in">ls</span> -al<br><span class="hljs-comment">#则会正确执行ls -al，因为ls -al 覆盖掉了dkfile-cmd中的【ls -a】</span><br></code></pre></td></tr></table></figure><p><strong>测试ENTRYPOINT</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 与上述环境相同</span><br><span class="hljs-comment"># 在ent中，执行构建好的镜像时,能追加命令</span><br>] vim dkfile-ent<br><br>FROM centos:7<br>ENTRYPOINT [<span class="hljs-string">&quot;ls&quot;</span>,<span class="hljs-string">&quot;-a&quot;</span>]<br><br>] docker build -f dkfile-ent -t enttest .<br><span class="hljs-comment"># 此时如果在指令后追加指令 【-l】</span><br>] docker run enttest -l<br><span class="hljs-comment">#此处会正确运行 【ls -al】指令，【-l】成功追加到 【ls -a】后</span><br></code></pre></td></tr></table></figure><h3 id="2-编写简单文件"><a href="#2-编写简单文件" class="headerlink" title="2. 编写简单文件"></a>2. 编写简单文件</h3><ul><li><p>构建自定义centos</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># 注意此处需要指定版本，因为默认centos8  不再维护，官方镜像源中已移除</span><br><span class="hljs-keyword">FROM</span> centos:<span class="hljs-number">7</span><br><span class="hljs-keyword">MAINTAINER</span> kongke&lt;<span class="hljs-number">2843732083</span>@qq.com&gt;<br><br><span class="hljs-keyword">ENV</span> MYPATH /usr/local<br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> <span class="hljs-variable">$MYPATH</span></span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> yum -y install vim</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> yum -y install net-tools</span><br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">80</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$MYPATH</span></span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;----end----&quot;</span></span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> /bin/bash</span><br><br></code></pre></td></tr></table></figure></li><li><p>构建文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 注意最后的点表示在当前目录的上下文关系</span><br>docker build -f mydkfile-ct -t mycentos:0.1 .<br></code></pre></td></tr></table></figure></li><li><p>查看构建过程</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">history</span> mycentos:0.1<br></code></pre></td></tr></table></figure></li></ul><h3 id="3-编写Tomcat镜像"><a href="#3-编写Tomcat镜像" class="headerlink" title="3. 编写Tomcat镜像"></a>3. 编写Tomcat镜像</h3><p>创建镜像目录，结构为</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-attr">--dkbuild</span><br><span class="hljs-attr">--dktomcat</span><br><span class="hljs-attr">--Dockerfile</span><br><span class="hljs-attr">--readme</span><span class="hljs-selector-class">.txt</span><br><span class="hljs-attr">--test</span><br><span class="hljs-attr">--dklogs</span><br></code></pre></td></tr></table></figure><ul><li><p>编写Dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> centos:<span class="hljs-number">7</span><br><span class="hljs-keyword">MAINTAINER</span> kongke&lt;<span class="hljs-number">2843732083</span>@qq.com&gt;<br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> readme.txt /usr/local/readme.txt</span><br><br><span class="hljs-keyword">ADD</span><span class="language-bash"> jdk-8u202-linux-x64.tar.gz /usr/local</span><br><span class="hljs-keyword">ADD</span><span class="language-bash"> apache-tomcat-9.0.80.tar.gz /usr/local</span><br><br><br><span class="hljs-keyword">ENV</span> MYPATH /usr/local<br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> <span class="hljs-variable">$MYPATH</span></span><br><br><span class="hljs-keyword">ENV</span> JAVA_HOME /usr/local/jdk1.<span class="hljs-number">8.0</span>_202<br><span class="hljs-keyword">ENV</span> CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br><span class="hljs-keyword">ENV</span> CATALINA_HOME /usr/local/apache-tomcat-<span class="hljs-number">9.0</span>.<span class="hljs-number">80</span><br><span class="hljs-keyword">ENV</span> CATALINA_BASH /usr/local/apache-tomcat-<span class="hljs-number">9.0</span>.<span class="hljs-number">80</span><br><span class="hljs-keyword">ENV</span> PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/bin:$CATALINA_HOME/lib<br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> /usr/local/apache-tomcat-9.0.80/bin/startup.sh</span><br><br></code></pre></td></tr></table></figure></li><li><p>构建镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 此处因为文件名为Dockerfile且在当前目录，所以不用指定文件</span><br>] docker build -t mytomcat .<br></code></pre></td></tr></table></figure></li><li><p>运行镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker run -it -p 9090:8080 --name mytomcat01 \<br><span class="hljs-comment"># 此处将项目目录挂载</span><br>-v /home/dkbuild/dktomcat/test:/usr/local/apache-tomcat-9.0.80/webapps/test \<br><span class="hljs-comment"># 将日志目录挂载</span><br>-v /home/dkbuild/dktomcat/dklogs:/usr/local/apache-tomcat-9.0.80/logs \<br>mytomcat /bin/bash<br></code></pre></td></tr></table></figure></li></ul><h2 id="五、发布镜像到远程仓库"><a href="#五、发布镜像到远程仓库" class="headerlink" title="五、发布镜像到远程仓库"></a>五、发布镜像到远程仓库</h2><h3 id="1-发布到DockerHub"><a href="#1-发布到DockerHub" class="headerlink" title="1. 发布到DockerHub"></a>1. 发布到DockerHub</h3><ul><li><p>登录DockerHub账号</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker login -u kongke7<br>password: <span class="hljs-comment">#输入密码</span><br>登录成功！<br></code></pre></td></tr></table></figure></li><li><p>更改镜像命名</p><blockquote><p>因为发布镜像的规范为 用户名&#x2F;镜像名:版本号 例如 -&gt; kongke7&#x2F;mytomcat:1.0</p><p>否则无法推送</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker tag 42c1543f639b kongke7/mytomcat:1.0 <br></code></pre></td></tr></table></figure></li><li><p>推送镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker push kongke7/mytomcat:1.0<br></code></pre></td></tr></table></figure></li></ul><h3 id="2-发布到阿里云镜像仓库"><a href="#2-发布到阿里云镜像仓库" class="headerlink" title="2. 发布到阿里云镜像仓库"></a>2. 发布到阿里云镜像仓库</h3><ul><li>登录阿里云Docker Registry</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ docker login --username=kongke registry.cn-hangzhou.aliyuncs.com<br></code></pre></td></tr></table></figure><blockquote><p>用于登录的用户名为阿里云账号全名，密码为开通服务时设置的密码。</p><p>您可以在访问凭证页面修改凭证密码。</p></blockquote><ul><li>从Registry中拉取镜像</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ docker pull registry.cn-hangzhou.aliyuncs.com/kongke7/kongke7-<span class="hljs-built_in">test</span>:[镜像版本号]<br></code></pre></td></tr></table></figure><ul><li>将镜像推送到Registry</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ docker login --username=kongke registry.cn-hangzhou.aliyuncs.com<br>$ docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/kongke7/kongke7-<span class="hljs-built_in">test</span>:[镜像版本号]<br>$ docker push registry.cn-hangzhou.aliyuncs.com/kongke7/kongke7-<span class="hljs-built_in">test</span>:[镜像版本号]<br></code></pre></td></tr></table></figure><blockquote><p>请根据实际镜像信息替换示例中的[ImageId]和[镜像版本号]参数。</p></blockquote><ul><li>选择合适的镜像仓库地址</li></ul><blockquote><p>从ECS推送镜像时，可以选择使用镜像仓库内网地址。推送速度将得到提升并且将不会损耗您的公网流量。</p><p>如果您使用的机器位于VPC网络，请使用 registry-vpc.cn-hangzhou.aliyuncs.com 作为Registry的域名登录。</p></blockquote><ul><li>示例</li></ul><blockquote><p>使用”docker tag”命令重命名镜像，并将它通过专有网络地址推送至Registry。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/kongke7/kongke7-<span class="hljs-built_in">test</span>:[镜像版本号]<br></code></pre></td></tr></table></figure><blockquote><p>使用 “docker push” 命令将该镜像推送至远程。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ docker push registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816<br></code></pre></td></tr></table></figure><h2 id="六、Docker网络"><a href="#六、Docker网络" class="headerlink" title="六、Docker网络"></a>六、Docker网络</h2><blockquote><p>当我们安装了Docker，就会多一个<strong>Docker0</strong>网卡，使用<strong>桥接模式</strong>连接网络</p><p>Docker每启动一个容器，都会为容器分配一个ip地址</p></blockquote><h3 id="1-Docker0"><a href="#1-Docker0" class="headerlink" title="1. Docker0"></a>1. Docker0</h3><blockquote><p>Docker0使用的<strong>veth-pair</strong>技术为容器间通信</p></blockquote><ul><li>使用  <code>ip addr</code>  命令查看地址，当启动了一个容器则会出现下图的网卡（75: veth2f50f93@if74）</li></ul><p><img src="https://s2.loli.net/2023/11/02/rMhz57yaNFJSgCe.png" alt="ipaddr"></p><ul><li>每当增加一个容器，则会对应多一对网卡（77: veth407b0c8@if76）</li></ul><p><img src="https://s2.loli.net/2023/11/02/8UsuB9qpiIKc7gC.png" alt="ipaddr2"></p><blockquote><p>则一对一对的网卡，就是veth-pair技术</p><p>veth-pair就是一对虚拟设备接口，一端连接协议，一端彼此相连</p><p>正因如此，veth-pair 充当一座桥梁，连接各种虚拟设备</p></blockquote><ul><li>如图所示，veth-pair连接的原理</li></ul><p><img src="https://s2.loli.net/2023/11/02/1tjQLpTMIv29rXH.png" alt="vethpair"></p><h3 id="2-自定义网路"><a href="#2-自定义网路" class="headerlink" title="2.自定义网路"></a>2.自定义网路</h3><ul><li><p><strong>网络模式</strong></p><table><thead><tr><th>模式</th><th>介绍</th></tr></thead><tbody><tr><td>bridge</td><td>桥接模式，docker默认</td></tr><tr><td>host</td><td>主机模式，与宿主机共享网路</td></tr><tr><td>none</td><td>不配置网络</td></tr><tr><td>container</td><td>容器网络连通（不常用，局限性大）</td></tr></tbody></table></li><li><p><strong>查看docker网络信息</strong></p><ul><li><p><code>docker network ls</code>：查看网络信息 （其中bridge为Docker0）</p><p><img src="https://s2.loli.net/2023/11/02/rJ3XF8b1EHfz94p.png" alt="network"></p></li><li><p><code>docker network inspect 网络id </code>：查看某个网络的具体信息</p></li></ul></li><li><p><strong>创建自定义网络</strong></p><ul><li><code>--driver</code>：网络模式，默认bridge</li><li><code>--subnet</code>：子网（划分网段）</li><li><code>--gateway</code>：网关（通常为当前网段的第一个ip）</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@localhost ~]  docker network create \<br>--driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet<br><br>4a17ecbfac448947ed9c0711ed291b3a63049832f8d23c3722e238bae15accc9<br>[root@localhost ~]  docker network <span class="hljs-built_in">ls</span><br>NETWORK ID     NAME      DRIVER    SCOPE<br>f26af714313b   bridge    bridge    <span class="hljs-built_in">local</span><br>50828ab4f805   host      host      <span class="hljs-built_in">local</span><br>4a17ecbfac44   mynet     bridge    <span class="hljs-built_in">local</span><br>e412b2fb7593   none      null      <span class="hljs-built_in">local</span><br></code></pre></td></tr></table></figure></li><li><p><strong>将容器运行到指定网络</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@localhost ~] docker run -d -name tomcat-net-01 --net mynet tomcat<br></code></pre></td></tr></table></figure></li><li><p>此时自定义网络内的容器可以通过容器名相互访问</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@localhost ~] docker <span class="hljs-built_in">exec</span> -it tomcat-net-01 ping tomcat-net-02<br></code></pre></td></tr></table></figure></li><li><p><strong>网络连通</strong></p><blockquote><p>因为网络之间相互隔离，正常情况下一个网络中的容器无法连通另一网络中的容器，</p><p>但是，通过将容器与另一网络相连则可实现网络连通</p><p>即，一个容器两个ip</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker network connect mynet tomcat01<br></code></pre></td></tr></table></figure></li></ul><h2 id="七、实战部署"><a href="#七、实战部署" class="headerlink" title="七、实战部署"></a>七、实战部署</h2><h3 id="1-Redis集群部署"><a href="#1-Redis集群部署" class="headerlink" title="1. Redis集群部署"></a>1. Redis集群部署</h3><ul><li><p>创建redis节点并启动各节点容器</p><p><strong>编写shell脚本执行任务</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>for port in $(seq 1 6);<br>do<br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建节点</span><br><br>        mkdir -p /mydata/dkredis/node-$&#123;port&#125;/conf<br>        touch /mydata/dkredis/node-$&#123;port&#125;/conf/redis.conf<br>        cat &lt;&lt; EOF &gt;/mydata/dkredis/node-$&#123;port&#125;/conf/redis.conf<br>port 6379<br>bind 0.0.0.0<br>cluster-enabled yes<br>cluster-config-file nodes.conf<br>cluster-node-timeout 5000<br>cluster-announce-ip 172.38.0.1$&#123;port&#125;<br>cluster-announce-port 6379<br>cluster-announce-bus-port 16379<br>appendonly yes<br>EOF<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">启动节点容器</span><br>docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \<br>-v /mydata/dkredis/node-$&#123;port&#125;/data:/data \<br>-v /mydata/dkredis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \<br>-d --net redis-net --ip 172.38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf;<br><br>done<br><br></code></pre></td></tr></table></figure></li><li><p>创建redis集群</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 进入redis-1节点容器</span><br><span class="hljs-comment"># 创建redis集群</span><br>] redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 \<br>172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/11/02/TWvGdbUDK3C6OYk.png" alt="redis-jq"></p></li><li><p>进入redis-1节点查看集群信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 进入节点</span><br>/data ] redis-cli -c<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 查看集群信息</span><br>127.0.0.1:6379&gt; cluster info<br></code></pre></td></tr></table></figure><img src="https://s2.loli.net/2023/11/02/KDZoRQU4PInavCW.png" alt="info" style="zoom:67%;" /><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 查看节点信息</span><br>127.0.0.1:6379&gt; cluster nodes<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/11/02/SxQhXfvFdaiwN24.png" alt="nodes"></p></li><li><p><strong>部署成功</strong></p></li></ul><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">       _ _                /\/|<span class="hljs-string"></span><br><span class="hljs-string">      (_) </span>|<span class="hljs-string">              </span>|<span class="hljs-string">/\/ </span><br><span class="hljs-string"> _ __  _</span>|<span class="hljs-string"> </span>|<span class="hljs-string">__   __ _  ___     </span><br><span class="hljs-string"></span>|<span class="hljs-string"> &#x27;_ \</span>|<span class="hljs-string"> </span>|<span class="hljs-string"> &#x27;_ \ / _` </span>|<span class="hljs-string">/ _ \    </span><br><span class="hljs-string"></span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> (_</span>|<span class="hljs-string"> </span>|<span class="hljs-string"> (_) </span>|<span class="hljs-string">   </span><br><span class="hljs-string"></span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">_</span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">\__,_</span>|<span class="hljs-string">\___/    </span><br><span class="hljs-string">                              </span><br><span class="hljs-string">                              </span><br></code></pre></td></tr></table></figure><h3 id="2-部署Springboot项目"><a href="#2-部署Springboot项目" class="headerlink" title="2. 部署Springboot项目"></a>2. 部署Springboot项目</h3><ul><li><p>编写简单springboot项目，并打成  <code>jar包</code> </p></li><li><p>编写Dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> java:<span class="hljs-number">8</span><br><br><span class="hljs-keyword">MAINTAINER</span> kongke&lt;<span class="hljs-number">2843732083</span>@qq.com&gt;<br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> *.jar /app.jar</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;--server.port=8080&quot;</span>]</span><br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span><br><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;java&quot;</span>,<span class="hljs-string">&quot;-jar&quot;</span>,<span class="hljs-string">&quot;/app.jar&quot;</span>]</span><br></code></pre></td></tr></table></figure></li><li><p>将<code>jar包</code>和<code>Dockerfile</code>上传至虚拟机</p></li><li><p>构建镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker build -t javawebtest:1.0 .<br></code></pre></td></tr></table></figure></li><li><p>启动容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">] docker run -d -p 8080:8080 --name javaweb javawebtest:1.0<br></code></pre></td></tr></table></figure></li><li><p>测试接口</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">] curl localhost:8080/hello<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/11/02/VuQXjskAnGywmE4.png" alt="res"></p></li><li><p><strong>部署成功！</strong></p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>部署</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java8-新特性</title>
    <link href="/2023/12/10/Java8/"/>
    <url>/2023/12/10/Java8/</url>
    
    <content type="html"><![CDATA[<h1 id="Java-8"><a href="#Java-8" class="headerlink" title="Java 8"></a>Java 8</h1><blockquote><p>Java 8   的新特性</p></blockquote><h2 id="一、Lambda表达式"><a href="#一、Lambda表达式" class="headerlink" title="一、Lambda表达式"></a>一、Lambda表达式</h2><h3 id="1-基本语法"><a href="#1-基本语法" class="headerlink" title="1. 基本语法"></a>1. 基本语法</h3><ul><li><code>(参数) -&gt; &#123;方法体&#125;</code></li><li><code>参数 -&gt; &#123;方法体&#125;</code>：当只有一个参数时，可以省略小括号</li><li><code>(参数) -&gt; 方法体</code>：当方法体只有一条语句时，可以省略大括号</li></ul><blockquote><ol><li>无参无返回值</li></ol></blockquote>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 正常写法          </span><br><span class="hljs-type">Runnable</span> <span class="hljs-variable">run1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>              <span class="hljs-meta">@Override</span><br>              <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                  System.out.println(<span class="hljs-string">&quot;AAA&quot;</span>);<br>              &#125;<br>          &#125;;<br>          <span class="hljs-comment">// lambda</span><br>          <span class="hljs-type">Runnable</span> <span class="hljs-variable">run2</span> <span class="hljs-operator">=</span> () -&gt; System.out.println(<span class="hljs-string">&quot;BBB&quot;</span>);<br></code></pre></td></tr></table></figure><blockquote><ol start="2"><li>一个参数 ， 无返回值</li></ol></blockquote>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 正常写法             </span><br>Consumer&lt;String&gt; con1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Consumer</span>&lt;String&gt;() &#123;<br>              <span class="hljs-meta">@Override</span><br>              <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(String s)</span> &#123;<br>                  System.out.println(s);<br>              &#125;<br>          &#125;;<br>          <span class="hljs-comment">// lambda</span><br>          Consumer&lt;String&gt; con2 = (String s) -&gt; &#123;<br>              System.out.println(s);<br>          &#125;;<br>          <span class="hljs-comment">// 当方法体只有一条语句时，大括号可以省略，（有无返回值都一样）</span><br>          Consumer&lt;String&gt; con3 = (String s) -&gt; System.out.println(s);<br>          <span class="hljs-comment">// 参数类型可以省略   (类型推断)</span><br>          Consumer&lt;String&gt; con4 = (s) -&gt; System.out.println(s);<br>          <span class="hljs-comment">// 一个参数可以省略括号</span><br>          Consumer&lt;String&gt; con5 = s -&gt; System.out.println(s);<br></code></pre></td></tr></table></figure><blockquote><ol start="3"><li>有两个以上接口，并且有返回值，有多条语句</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 正常写法        </span><br>Comparator&lt;Integer&gt; com1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>&lt;Integer&gt;() &#123;<br>              <span class="hljs-meta">@Override</span><br>              <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Integer o1, Integer o2)</span> &#123;<br>                  System.out.println(<span class="hljs-string">&quot;两数比较&quot;</span>);<br>                  <span class="hljs-keyword">return</span> o1.compareTo(o2);<br>              &#125;<br>          &#125;;<br>          <span class="hljs-comment">// lambda</span><br>          <span class="hljs-comment">// 单条语句</span><br>          Comparator&lt;Integer&gt; com2 = (o1, o2) -&gt; o1.compareTo(o2);<br>          <span class="hljs-comment">// 多条语句</span><br>          Comparator&lt;Integer&gt; com3 = (o1, o2) -&gt; &#123;<br>              System.out.println(<span class="hljs-string">&quot;HHH&quot;</span>);<br>              <span class="hljs-keyword">return</span> o1.compareTo(o2);<br>          &#125;;<br></code></pre></td></tr></table></figure><h3 id="2-函数式接口"><a href="#2-函数式接口" class="headerlink" title="2. 函数式接口"></a>2. 函数式接口</h3><ul><li><p><strong>Java四个基本函数式接口</strong></p><table><thead><tr><th>名称</th><th>抽象方法</th></tr></thead><tbody><tr><td>Consumer<T>  消费型</td><td>void accept(T t)</td></tr><tr><td>Predicate<T>    判定型</td><td>boolean test(T t)</td></tr><tr><td>Supplier<T>      供给型</td><td>T get()</td></tr><tr><td>Function&lt;T,R&gt;   函数型</td><td>R apply(T t)</td></tr></tbody></table></li><li><p>示例</p><ul><li><p><code>Consumer&lt;T&gt;</code> 消费型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">functionInterCons</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 正常写法</span><br>        cons(<span class="hljs-number">500.0</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Consumer</span>&lt;Double&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Double aDouble)</span> &#123;<br>                System.out.printf(<span class="hljs-string">&quot;消费%.2f元\n&quot;</span>, aDouble);<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">//lambda</span><br>        cons(<span class="hljs-number">500.0</span>, money -&gt; System.out.printf(<span class="hljs-string">&quot;消费%.2f元\n&quot;</span>, money));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cons</span><span class="hljs-params">(Double money, Consumer&lt;Double&gt; con)</span> &#123;<br>        con.accept(money);<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p><code>Predicate&lt;T&gt;</code> 判定型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">functionInterPre</span><span class="hljs-params">()</span> &#123;<br>        List&lt;String&gt; list = Arrays.asList(<span class="hljs-string">&quot;AA&quot;</span>, <span class="hljs-string">&quot;AB&quot;</span>, <span class="hljs-string">&quot;AC&quot;</span>, <span class="hljs-string">&quot;CC&quot;</span>);<br>        <span class="hljs-comment">// 正常写法</span><br>    List&lt;String&gt; res = pres(list, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Predicate</span>&lt;String&gt;() &#123;<br>            <span class="hljs-comment">/**</span><br><span class="hljs-comment">             * 判定条件</span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">test</span><span class="hljs-params">(String s)</span> &#123;<br>                <span class="hljs-keyword">return</span> s.contains(<span class="hljs-string">&quot;A&quot;</span>);<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// lambda</span><br>        System.out.println(pres(list, s -&gt; s.contains(<span class="hljs-string">&quot;A&quot;</span>)));<br><br>        System.out.println(res);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">pres</span><span class="hljs-params">(List&lt;String&gt; list, Predicate&lt;String&gt; pre)</span>&#123;<br>        List&lt;String&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (String s : list) &#123;<br>            <span class="hljs-comment">// pre中只有一个方法</span><br>            <span class="hljs-keyword">if</span> (pre.test(s)) &#123;<br>                res.add(s);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p><code>Supplier&lt;T&gt;</code> 供给型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">functionInterSup</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 正常写法</span><br>    supp(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Supplier</span>&lt;String&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> String <span class="hljs-title function_">get</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;str&quot;</span>;<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// lambda</span><br>        supp(() -&gt; <span class="hljs-string">&quot;str&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">supp</span><span class="hljs-params">(Supplier&lt;String&gt; sup)</span> &#123;<br>        System.out.println(sup.get());<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p><code>Function&lt;T,R&gt;</code> 函数型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">functionInterFunc</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 正常写法</span><br>    func((<span class="hljs-type">byte</span>) <span class="hljs-number">127</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>&lt;Byte, Integer&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">apply</span><span class="hljs-params">(Byte aByte)</span> &#123;<br>                <span class="hljs-keyword">return</span> aByte + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// lambda</span><br>        func((<span class="hljs-type">byte</span>) -<span class="hljs-number">128</span>, b -&gt; b - <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">func</span><span class="hljs-params">(Byte bytes, Function&lt;Byte, Integer&gt; func)</span> &#123;<br>        System.out.println(func.apply(bytes));<br>    &#125;<br></code></pre></td></tr></table></figure></li></ul></li></ul><h3 id="3-方法引用"><a href="#3-方法引用" class="headerlink" title="3. 方法引用"></a>3. 方法引用</h3><blockquote><p>实现的方法需要与抽象方法参数类型及返回值类型一致</p></blockquote><ul><li><p>使用格式：<code>类(或对象) :: 方法名</code></p><ul><li><p><code>类 :: 静态方法名</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Java">Supplier&lt;Long&gt; sup2 = System::currentTimeMillis;<br>      System.out.println(sup2.get());<br>      <span class="hljs-comment">// Comparator&lt;T&gt; int compare(T t1 , T t2)</span><br>      Comparator&lt;Integer&gt; com1 = (o1, o2) -&gt; Integer.compare(o1, o2);<br>      Comparator&lt;Integer&gt; com2 = Integer::compare;<br>com1.compare(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure></li><li><p><code>类 :: 非静态方法名</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// BiPredicate&lt;T,T&gt; boolean test(T t1, T t2)</span><br>      BiPredicate&lt;String, String&gt; bip = (s1, s2) -&gt; s1.equals(s2);<br>      <span class="hljs-comment">// String boolean s1.equals(s2)</span><br>      BiPredicate&lt;String, String&gt; bip2 = String::equals;<br>bip.test(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>)<br></code></pre></td></tr></table></figure></li><li><p><code>对象 :: 非静态方法名</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java">Consumer&lt;String&gt; cons = s -&gt; System.out.println(s);<br>      <span class="hljs-type">PrintStream</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> System.out;<br>      cons = ps::println;<br>cons.accept(<span class="hljs-string">&quot;str&quot;</span>);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h3 id="4-构造器引用"><a href="#4-构造器引用" class="headerlink" title="4. 构造器引用"></a>4. 构造器引用</h3><blockquote><p>需要与抽象方法参数类型及返回值类型一致<br>需要实体类中存在对应的有参构造器</p></blockquote><ul><li><p><strong>无参</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java">Supplier&lt;Book&gt; sup = () -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>();<br>Supplier&lt;Book&gt; sup2 = Book::<span class="hljs-keyword">new</span>;<br><br><span class="hljs-type">Book</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> sup.get();<br></code></pre></td></tr></table></figure></li><li><p><strong>有参</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java">Function&lt;String, Book&gt; func1 = s -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(s);<br>Function&lt;String, Book&gt; func2 = Book::<span class="hljs-keyword">new</span>;<br><br><span class="hljs-type">Book</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> func1.apply(<span class="hljs-string">&quot;A&quot;</span>);<br><span class="hljs-type">Book</span> <span class="hljs-variable">b1</span> <span class="hljs-operator">=</span> func2.apply(<span class="hljs-string">&quot;B&quot;</span>);<br></code></pre></td></tr></table></figure></li><li><p><strong>多参</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java">BiFunction&lt;String, Integer, Book&gt; bf1 = (s, i) -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(s, i);<br>BiFunction&lt;String, Integer, Book&gt; bf2 = Book::<span class="hljs-keyword">new</span>;<br><br><span class="hljs-type">Book</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> bf1.apply(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">10</span>);<br><span class="hljs-type">Book</span> <span class="hljs-variable">b1</span> <span class="hljs-operator">=</span> bf2.apply(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure></li></ul><h3 id="5-数组引用"><a href="#5-数组引用" class="headerlink" title="5. 数组引用"></a>5. 数组引用</h3><blockquote><p>将数组看成一个对象 ， 与构造器引用类似</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java">Function&lt;Integer, String[]&gt; fun1 = len -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[len];<br>Function&lt;Integer, String[]&gt; fun2 = String[]::<span class="hljs-keyword">new</span>;<br><br>String[] arr = fun1.apply(<span class="hljs-number">5</span>);<br>String[] arr1 = fun2.apply(<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><h2 id="二、Stream-API"><a href="#二、Stream-API" class="headerlink" title="二、Stream API"></a>二、Stream API</h2><blockquote><p>Stream流获取操作对象，不改变原对象的值</p></blockquote><table><thead><tr><th>类型</th><th>定义</th></tr></thead><tbody><tr><td>顺序流</td><td>Stream<T>  stream()</td></tr><tr><td>并行流</td><td>Stream<T>  parallelStream()</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">        List&lt;Book&gt; books = Book.getBooks(<span class="hljs-number">10</span>);<br><span class="hljs-comment">//        default Stream&lt;T&gt; stream() 顺序流</span><br>        Stream&lt;Book&gt; stream = books.stream();<br><span class="hljs-comment">//        default Stream&lt;T&gt; parallelStream() 并行流</span><br>        Stream&lt;Book&gt; praStream = books.parallelStream();<br></code></pre></td></tr></table></figure><h3 id="1-获取流"><a href="#1-获取流" class="headerlink" title="1. 获取流"></a>1. 获取流</h3><ul><li><p>集合获取流</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java">        List&lt;Book&gt; books = Book.getBooks(<span class="hljs-number">10</span>);<br><span class="hljs-comment">//        default Stream&lt;T&gt; stream() 顺序流</span><br>        Stream&lt;Book&gt; stream = books.stream();<br></code></pre></td></tr></table></figure></li><li><p>数组获取流</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"> <span class="hljs-type">int</span>[] arr = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;;<br>        <span class="hljs-type">IntStream</span> <span class="hljs-variable">intStream</span> <span class="hljs-operator">=</span> Arrays.stream(arr);<br><span class="hljs-comment">//      支持泛型</span><br>        Book[] bookArr = &#123;<span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">&quot;a&quot;</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">&quot;b&quot;</span>)&#125;;<br>        Stream&lt;Book&gt; bookStream = Arrays.stream(bookArr);<br></code></pre></td></tr></table></figure></li><li><p>Stream.of() 创建</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream&lt;Integer&gt; integerStream = Stream.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br>Stream&lt;Book&gt; bookStream1 = Stream.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>());<br></code></pre></td></tr></table></figure></li><li><p>无限流</p><ul><li><p>迭代</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">//  public static&lt;T&gt; Stream&lt;T&gt; </span><br><span class="hljs-comment">//iterate(final T seed, final UnaryOperator&lt;T&gt; f)</span><br>Stream.iterate(<span class="hljs-number">0</span>, t -&gt; t + <span class="hljs-number">2</span>)<br>    .limit(<span class="hljs-number">10</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure></li><li><p>生成</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// public static&lt;T&gt; Stream&lt;T&gt; generate(Supplier&lt;T&gt; S)     </span><br>Stream.generate(Math::random)<br>    .limit(<span class="hljs-number">5</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h3 id="2-中间操作"><a href="#2-中间操作" class="headerlink" title="2. 中间操作"></a>2. 中间操作</h3><ul><li><p><strong>过滤</strong>   <code>filter&lt;P&gt;</code></p><blockquote><p>根据过滤器中的 Predicate 过滤</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// Stream&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate)</span><br>Stream&lt;Book&gt; bookStream = books.stream();<br><span class="hljs-comment">// filter 过滤价格大于50的书📕</span><br>bookStream.filter(b -&gt; b.getPrice() &gt; <span class="hljs-number">50</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure></li><li><p><strong>截断</strong>   <code>limit(n)</code></p><blockquote><p>截取流中前 n 个数据</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">books.stream().limit(<span class="hljs-number">5</span>).forEach(books1::add);<br></code></pre></td></tr></table></figure></li><li><p><strong>跳过</strong>   <code>skip(n)</code></p><blockquote><p>跳过前 n 个数据</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">books.stream().skip(<span class="hljs-number">5</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure></li><li><p><strong>筛选</strong>   <code>distinct()</code></p><blockquote><p>通过流产生的 hashCode 和 equals 去除重复元素</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">books.stream().distinct().forEach(System.out::println);<br></code></pre></td></tr></table></figure></li></ul><p><strong>Map映射操作</strong></p><ul><li><p><code>map(Function f)</code></p><blockquote><p>接收一个函数作为参数，这个函数会作用到每一个元素上，并映射成为一个新的元素</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 将小写字母映射为大写返回</span><br>List&lt;String&gt; list = Arrays.asList(<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-string">&quot;bb&quot;</span>, <span class="hljs-string">&quot;cc&quot;</span>);<br>String[] arr = &#123;<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-string">&quot;bb&quot;</span>, <span class="hljs-string">&quot;cc&quot;</span>&#125;;<br><span class="hljs-comment">// 列表</span><br>list.stream().map(String::toUpperCase).forEach(System.out::println);<br><span class="hljs-comment">// 数组</span><br>Arrays.stream(arr).map(String::toUpperCase).forEach(System.out::println);<br></code></pre></td></tr></table></figure><ul><li><p>获取Books中价格大于30的书</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java">books.stream()<br>    .map(Book::getPrice)<br>    .filter(s -&gt; s &gt; <span class="hljs-number">30</span>)<br>    .forEach(System.out::println);<br></code></pre></td></tr></table></figure></li></ul></li><li><p><code>flatMap(Function f)</code></p><blockquote><p>接收一个函数作为参数，将流中的每一个值都转换成一个流，最后将所有的流合成一个流</p></blockquote><ul><li><p>将 <code>[[a,a],[b,b],[c,c]] </code>  变成  <code> [a,a,b,b,c,c]</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// 本类为 StreamA</span><br><span class="hljs-comment">// list = Arrays.asList(&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;);</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 将字符串转化为流</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Stream&lt;Character&gt; <span class="hljs-title function_">strToStream</span><span class="hljs-params">(String str)</span> &#123;<br>   List&lt;Character&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>   <span class="hljs-keyword">for</span> (Character c : str.toCharArray()) &#123;<br>       list.add(c);<br>   &#125;<br>   <span class="hljs-keyword">return</span> list.stream();<br>&#125;<br><br><span class="hljs-comment">// 使用普通map 返回值类型为流的集合</span><br>Stream&lt;Stream&lt;Character&gt;&gt; streamStream = <br>    list.stream().map(StreamA::strToStream);<br>    <span class="hljs-comment">// 遍历每个流中的每一个元素</span><br>streamStream.forEach(s -&gt; &#123;<br>   s.forEach(System.out::println);<br>&#125;);<br><br><span class="hljs-comment">//使用flatMap 返回的类型为一个流</span><br>Stream&lt;Character&gt; characterStream = <br>    list.stream().flatMap(StreamA::strToStream);<br><br>characterStream.forEach(System.out::println);<br></code></pre></td></tr></table></figure></li></ul></li></ul><p><strong>Sorted排序操作</strong></p><ul><li><p><code>sorted()</code>  自然排序 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java">List&lt;Integer&gt; list = Arrays.asList(<span class="hljs-number">12</span>, <span class="hljs-number">43</span>, <span class="hljs-number">65</span>, <span class="hljs-number">34</span>, <span class="hljs-number">87</span>, <span class="hljs-number">99</span>, <span class="hljs-number">23</span>, <span class="hljs-number">11</span>);<br><span class="hljs-comment">// (默认从小到大)</span><br>list.stream().sorted().forEach(System.out::println);<br></code></pre></td></tr></table></figure></li><li><p><code>sorted(Comparator com)</code>   自定义排序</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Book&gt; books = Book.getBooks(<span class="hljs-number">10</span>);<br>books.stream()<br>    .sorted(Comparator.comparingInt(Book::getPrice))<br>    .forEach(System.out::println);<br><span class="hljs-comment">// 加上 - 号 表示改变顺序</span><br>books.stream()<br>    .sorted((b1,b2) -&gt; - Integer.compare(b1.getPrice(), b2.getPrice()))<br>    .forEach(System.out::println);<br><br></code></pre></td></tr></table></figure></li></ul><h3 id="3-终止操作"><a href="#3-终止操作" class="headerlink" title="3. 终止操作"></a>3. 终止操作</h3><blockquote><p>操作结束后会关闭流</p></blockquote><p><strong>基本常见操作</strong></p><ul><li><p><code>forEach(Consumer con)</code>  将元素遍历</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">list.stream().forEach(System.out::println);<br></code></pre></td></tr></table></figure></li><li><p><code>allMatch(Predicate p)</code>   检查是否匹配所有元素</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">books.stream().allMatch(b -&gt; b.getPrice() &lt; <span class="hljs-number">50</span>)<br></code></pre></td></tr></table></figure></li><li><p><code>anyMatch(Predicate p)</code>   检查是否至少匹配一个元素</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">books.stream().anyMatch(b -&gt; b.getPrice() &gt; <span class="hljs-number">50</span>)<br></code></pre></td></tr></table></figure></li><li><p><code>noneMatch(Predicate p)</code> 检查是否 没有匹配的元素</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">books.stream().noneMatch(b -&gt; b.getName().startsWith(<span class="hljs-string">&quot;a&quot;</span>))<br></code></pre></td></tr></table></figure></li><li><p><code>findFirst()</code>  取流中的第一个元素</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Optional&lt;Book&gt; first = books.stream().findFirst();<br></code></pre></td></tr></table></figure></li><li><p><code>findAny()</code>   取流中的任意一个元素</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">Optional&lt;Book&gt; any = books.parallelStream().findAny();<br></code></pre></td></tr></table></figure></li></ul><p><strong>计数操作</strong></p><ul><li><p><code>count()</code>    返回流中集合个数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> books.stream().filter(b -&gt; b.getPrice() &gt; <span class="hljs-number">50</span>).count();<br></code></pre></td></tr></table></figure></li><li><p><code>max(Comparator c)</code>   返回流中的最大值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java">Stream&lt;Integer&gt; priceStream = books.stream().map(Book::getPrice);<br>Optional&lt;Integer&gt; max = priceStream.max(Integer::compare);<br></code></pre></td></tr></table></figure></li><li><p><code>min(Comparator c)</code>   返回流中的最小值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java">Optional&lt;Integer&gt; min = books.stream()<br>    .map(Book::getPrice).min(Integer::compareTo);<br></code></pre></td></tr></table></figure></li></ul><p><strong>归约操作</strong></p><blockquote><p>将流中的集合反复结合起来，得到一个值</p></blockquote><ul><li><p><code>reduce(T identity , BinaryOperator bo)</code>  得到一个值，返回 <code>T</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Integer</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> list.stream().reduce(<span class="hljs-number">0</span>, (i, j) -&gt; i + j);<br><span class="hljs-comment">// 或</span><br><span class="hljs-type">Integer</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> list.stream().reduce(<span class="hljs-number">0</span>, Integer::sum);<br></code></pre></td></tr></table></figure></li><li><p><code>reduce(BinaryOperator bo)</code>  得到一个值，返回 <code>Optional&lt;T&gt;</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java">Optional&lt;Integer&gt; sumPrice = books.stream()<br>    .map(Book::getPrice).reduce(Integer::sum);<br></code></pre></td></tr></table></figure></li></ul><p><strong>收集操作</strong></p><blockquote><p>将流中的元素转化为其他形式，接收一个Collector接口的实现，用于对流中的对象进行汇总</p></blockquote><ul><li><p><code>collect(Collector c)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Book&gt; collect = <br>    books.stream()<br>    .filter(b -&gt; b.getPrice() &gt; <span class="hljs-number">50</span>)<br>    .collect(Collectors.toList());<br><span class="hljs-comment">// 或</span><br>List&lt;Book&gt; collect2 = <br>    books.stream()<br>    .filter(b -&gt; b.getPrice() &gt; <span class="hljs-number">50</span>)<br>    .collect(Collectors.toCollection(ArrayList&lt;Book&gt;::<span class="hljs-keyword">new</span>));<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 常见：</span><br>Collectors.toList() <br>Collectors.toSet() <br>Collectors.toCollection(Supplier s)<br></code></pre></td></tr></table></figure><h2 id="三、Optional-类"><a href="#三、Optional-类" class="headerlink" title="三、Optional 类"></a>三、Optional 类</h2><blockquote><p>用来预防空指针</p><p>就能不用显示进行空指针检测</p></blockquote><h3 id="1-创建实例"><a href="#1-创建实例" class="headerlink" title="1. 创建实例"></a>1. 创建实例</h3><ul><li><p><code>Optional.of(T t)</code>   创建一个 Optional实例 ， t  必须非空</p></li><li><p><code>Optional.empty()</code>  创建一个空的Optional 实例</p></li><li><p><code>Optional.ofNullable(T t)</code>  创建一个 Optional实例 ， t 可以为空</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOptional</span><span class="hljs-params">()</span>&#123;<br>   <span class="hljs-type">Library</span> <span class="hljs-variable">lib</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Library</span>();<br><span class="hljs-comment">// lib = null;</span><br><span class="hljs-comment">// 如 lib = null 会报错 空指针 因为of中的示例不能为空</span><br>   Optional&lt;Library&gt; olib = Optional.of(lib);<br><br><span class="hljs-comment">// empty() 创建一个空的Optional 实例</span><br>   Optional&lt;Object&gt; empty = Optional.empty();<br>   System.out.println(empty);<br><br><span class="hljs-comment">//  ofNullable(T t) 创建一个 Optional实例 ， t可以为空</span><br>    Optional&lt;Library&gt; olib1 = Optional.ofNullable(lib);<br><br>    System.out.println(olib1);<br><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="2-获取容器中的对象"><a href="#2-获取容器中的对象" class="headerlink" title="2. 获取容器中的对象"></a>2. 获取容器中的对象</h3><ul><li><code>T get()</code> 调用的容器中有对象，不能为空</li><li><code>T orElse(T other)</code> 如果容器中有对象则返回 ， 没有则返回指定的 other对象</li><li><code>boolean isPresent()</code> 是否包含对象</li></ul><h3 id="3-预防空指针"><a href="#3-预防空指针" class="headerlink" title="3. 预防空指针"></a>3. 预防空指针</h3><p><strong>例 ：获取书名预防空指针异常</strong></p><ul><li><p>在 <code>Optional </code>以前防止空指针</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取书籍名称</span><br><span class="hljs-comment"> * 在Optional以前防止空指针</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getBookName</span><span class="hljs-params">(Library lib)</span>&#123;<br>    <span class="hljs-keyword">if</span> (lib != <span class="hljs-literal">null</span>)&#123;<br>    <span class="hljs-keyword">if</span> (lib.getBook() != <span class="hljs-literal">null</span>)&#123;<br>    <span class="hljs-keyword">return</span> lib.getBook().getName();<br>    &#125;<br>     &#125;<br>     <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><code>Optional </code>防止空指针</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getBookNameOp</span><span class="hljs-params">(Library lib)</span>&#123;<br><br>    Optional&lt;Library&gt; libo = Optional.ofNullable(lib);<br>    <span class="hljs-comment">// 这里解决 lib == null</span><br>    <span class="hljs-comment">// 如果 lib == null 则返回书名为 AA</span><br>    <span class="hljs-type">Library</span> <span class="hljs-variable">lib1</span> <span class="hljs-operator">=</span> libo.orElse(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Library</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">&quot;AA&quot;</span>)));<br><br><span class="hljs-comment">//  此时lib1不为空</span><br><br>    <span class="hljs-type">Book</span> <span class="hljs-variable">book1</span> <span class="hljs-operator">=</span> lib1.getBook();<br><br>    Optional&lt;Book&gt; booko = Optional.ofNullable(book1);<br>    <span class="hljs-comment">// 这里解决 lib.getBook() == null</span><br>    <span class="hljs-comment">// 如果 lib != null 且 lib.book == null 则返回书名为 BB</span><br>    <span class="hljs-type">Book</span> <span class="hljs-variable">book</span> <span class="hljs-operator">=</span> booko.orElse(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">&quot;BB&quot;</span>));<br><br><span class="hljs-comment">//  此时book不为空</span><br>    <span class="hljs-keyword">return</span> book.getName();<br>&#125;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>正则表达式</title>
    <link href="/2023/12/10/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2023/12/10/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><h2 id="一、语法与元字符"><a href="#一、语法与元字符" class="headerlink" title="一、语法与元字符"></a>一、语法与元字符</h2><h3 id="1-基本语法与元字符"><a href="#1-基本语法与元字符" class="headerlink" title="1. 基本语法与元字符"></a>1. 基本语法与元字符</h3><ul><li><p>基本语法与元字符</p><p><img src="https://s2.loli.net/2023/11/02/fopEa5KnHdjAe9D.png" alt="yufa1"></p><p><img src="https://s2.loli.net/2023/11/02/3UCb2DxnqPF4hsN.png" alt="yufa2"></p></li><li><p><code>\\s</code>：匹配空白字符</p></li><li><p><code>\\S</code>：与<code>\\s</code>取反，匹配任意非空白字符</p></li><li><p><code>.</code>：匹配除换行符外的所有字符（Java中换行符为 <code>\n</code>）</p></li><li><p><code>(?i)</code> 忽略大小写</p><ul><li><code>a(?i)bc</code> 对bc忽略大小写</li><li><code>a((?i)b)c</code> 对b忽略大小写</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// 在Java中 加上Pattern.CASE_INSENSITIVE 也表示忽略大小写</span><br><span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> Pattern.compile(regex , Pattern.CASE_INSENSITIVE);<br></code></pre></td></tr></table></figure><ul><li><p><code>|</code> ：选择匹配符</p><ul><li><code>ab|cd</code>：匹配 <code>ab</code> 或者 <code>cd</code></li></ul></li></ul><h3 id="2-限定符"><a href="#2-限定符" class="headerlink" title="2. 限定符"></a>2. 限定符</h3><blockquote><p>用于指定其之前的字符或组合连续出现的次数</p></blockquote><p><img src="https://s2.loli.net/2023/11/02/AucSWZJjmPVqUI4.png" alt="yufa3"></p><p><img src="https://s2.loli.net/2023/11/02/Oxi9W41HkvMhwCq.png" alt="yufa4"></p><h3 id="3-定位符"><a href="#3-定位符" class="headerlink" title="3. 定位符"></a>3. 定位符</h3><blockquote><p>规定字符在字符串中的位置</p></blockquote><p><img src="https://s2.loli.net/2023/11/02/oB5vE4R7wOiLhaK.png" alt="dw"></p><ul><li><code>\\b</code>：这里边界指一个单词的结尾 若字符串中有空格，则空格作为分隔符分隔单词</li><li><code>\\B</code>：指每个单词的开头或中间</li></ul><h3 id="4-捕获分组"><a href="#4-捕获分组" class="headerlink" title="4. 捕获分组"></a>4. 捕获分组</h3><p><img src="https://s2.loli.net/2023/11/02/vTNwWRPfGpgxFCd.png" alt="fz"></p><ul><li><p><code>(pattern)</code> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;([0-9]&#123;2&#125;)(\\d)(\\d)&quot;</span>;<br></code></pre></td></tr></table></figure></li><li><p><code>(?&lt;name&gt;pattern)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;(?&lt;g1&gt;[0-9]&#123;2&#125;)(?&lt;g2&gt;\\d)(?&lt;g3&gt;\\d)&quot;</span>;<br></code></pre></td></tr></table></figure></li></ul><h3 id="5-非捕获分组"><a href="#5-非捕获分组" class="headerlink" title="5.非捕获分组"></a>5.非捕获分组</h3><p><img src="https://s2.loli.net/2023/11/02/c7vGm5Nj9oOACwM.png" alt="fz2"></p><ul><li><p><code>(?:pattern)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jack=10 bob=19 tom=10&quot;</span>;<br><br><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\\w*=(?:10)&quot;</span>;<br><span class="hljs-comment">//得到 jack=10 tom=10</span><br></code></pre></td></tr></table></figure></li><li><p><code>(?=pattern)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\\w*=(?=10)&quot;</span>;<br><span class="hljs-comment">//得到 jack= tom=</span><br></code></pre></td></tr></table></figure></li><li><p><code>(?!pattern)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\\w*=(?!10)&quot;</span>;<br><span class="hljs-comment">//得到 bob=</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="6-反向引用"><a href="#6-反向引用" class="headerlink" title="6.反向引用"></a>6.反向引用</h3><blockquote><p>内部：在正则表达式中引用</p><p>外部：在其他方法中引用</p></blockquote><ul><li><code>\\n</code> 内部反向引用<ul><li>表示正则式中第n组匹配的值</li><li>**n **  表示一个捕获分组，在group中的组序号</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;12312-111222333&quot;</span>;<br><span class="hljs-comment">// 匹配如 15237-333444555 的编号</span><br><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\\d&#123;5&#125;-(\\d)\\1&#123;2&#125;(\\d)\\2&#123;2&#125;(\\d)\\3&#123;2&#125;&quot;</span>;<br></code></pre></td></tr></table></figure><ul><li><p><code>$n</code> 外部反向引用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern1</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;(.)\\1+&quot;</span>);<br><span class="hljs-type">Matcher</span> <span class="hljs-variable">matcher1</span> <span class="hljs-operator">=</span> pattern1.matcher(s);<br><span class="hljs-comment">// 使用外部反向引用，$1 表示正则式中的第一个分组捕获的值</span><br><span class="hljs-type">String</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> matcher1.replaceAll(<span class="hljs-string">&quot;$1&quot;</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="7-贪婪匹配与懒惰匹配"><a href="#7-贪婪匹配与懒惰匹配" class="headerlink" title="7. 贪婪匹配与懒惰匹配"></a>7. 贪婪匹配与懒惰匹配</h3><blockquote><p>正则表达式中默认为贪婪匹配</p><p>懒惰匹配  -&gt; 尽可能少的匹配</p><p>默认为贪婪匹配  -&gt; 尽可能多的匹配</p></blockquote><p><img src="https://s2.loli.net/2023/11/02/qkhG4mK7vg1B5oC.png" alt="lazzy"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;asd123123ds&quot;</span>;<br><span class="hljs-comment">// 默认贪婪匹配</span><br><span class="hljs-comment">// String regex = &quot;\\d+&quot;;</span><br><span class="hljs-comment">// 得到123123</span><br><br><span class="hljs-comment">// 懒惰匹配</span><br><span class="hljs-comment">// tring regex = &quot;\\d+?&quot;;</span><br><span class="hljs-comment">// 得到 1 2 3 1 2 3</span><br><br><span class="hljs-comment">// String regex = &quot;&lt;\\w.+&gt;&quot;;</span><br><span class="hljs-comment">// 得到 &lt;b name=123/&gt;&lt;b name=321/&gt;</span><br><span class="hljs-type">String</span> <span class="hljs-variable">str1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;b name=123/&gt;&lt;b name=321/&gt;&quot;</span>;<br><span class="hljs-comment">// 懒惰匹配</span><br><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;\\w.+?&gt;&quot;</span>;<br><span class="hljs-comment">// 得到 &lt;b name=123/&gt;和&lt;b name=321/&gt;</span><br></code></pre></td></tr></table></figure><h2 id="三、Java中常用的三个类"><a href="#三、Java中常用的三个类" class="headerlink" title="三、Java中常用的三个类"></a>三、Java中常用的三个类</h2><h3 id="1-Pattern"><a href="#1-Pattern" class="headerlink" title="1. Pattern"></a>1. Pattern</h3><ul><li><p><code>matches(regex , url)</code> 整体匹配，只能返回Boolean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span> <span class="hljs-variable">isMatch</span> <span class="hljs-operator">=</span> Pattern.matches(regex, url);<br></code></pre></td></tr></table></figure></li><li><p><code>compile(regex)</code> 返回正则表达式对象 能用于生成匹配器对象 传入匹配器的字符串中只要有符合的就能匹配，能输出结果值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> Pattern.compile(regex);<br><span class="hljs-type">Matcher</span> <span class="hljs-variable">matcher</span> <span class="hljs-operator">=</span> pattern.matcher(str);<br><br><span class="hljs-keyword">while</span> (matcher.find())&#123;<br>    System.out.println(matcher.group(<span class="hljs-number">0</span>));<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="2-Matcher"><a href="#2-Matcher" class="headerlink" title="2. Matcher"></a>2. Matcher</h3><blockquote><p>matcher 是一个匹配对象</p></blockquote><p><img src="https://s2.loli.net/2023/11/02/7H1lKGa4LRvJIiu.png" alt="matcher"></p><p><img src="https://s2.loli.net/2023/11/02/vxWUclC8OnhNA2D.png" alt="matcher2"></p><h3 id="3-String"><a href="#3-String" class="headerlink" title="3. String"></a>3. String</h3><ul><li><p><code>replaceAll(regex , s)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdk1.3dadasdasdjdk1.4asdas3423dfsjdk1.5&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> str.replaceAll(<span class="hljs-string">&quot;jdk\\d+\\.\\d+&quot;</span>, <span class="hljs-string">&quot;JDK&quot;</span>);<br></code></pre></td></tr></table></figure></li><li><p><code>matches(regex)</code> 整体匹配</p></li><li><p><code>split(regex)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">str2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;AAA#CCC&amp;AAA~CCC12GGG&quot;</span>;<br><span class="hljs-comment">//用#~&amp;数字分割字符串</span><br>str2.split(<span class="hljs-string">&quot;[#&amp;~]|\\d+&quot;</span>);<br></code></pre></td></tr></table></figure></li></ul><h2 id="二、实际应用"><a href="#二、实际应用" class="headerlink" title="二、实际应用"></a>二、实际应用</h2><h3 id="1-判断汉字"><a href="#1-判断汉字" class="headerlink" title="1. 判断汉字"></a>1. 判断汉字</h3><blockquote><p>注意汉字的编码范围在    <strong><code>\u0391-\uffe5</code></strong> ，**<code>\u4e00-\u9fa5</code>**</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;你好你好你好&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^[\u4e00-\u9fa5]+$&quot;</span>;<br></code></pre></td></tr></table></figure><h3 id="2-判断邮编"><a href="#2-判断邮编" class="headerlink" title="2. 判断邮编"></a>2. 判断邮编</h3><blockquote><p>以1开头的六位数字</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;110203&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^[1-9]\\d&#123;5&#125;$&quot;</span>;<br></code></pre></td></tr></table></figure><h3 id="3-判断URL"><a href="#3-判断URL" class="headerlink" title="3. 判断URL"></a>3. 判断URL</h3><p><code>^((http)s?://)?([\\w-]+\\.)+[a-zA-Z0-9]+((/[\\w-#]+)+\\?([\\w-]+=[\\w-]+&amp;?)*)?$</code></p><ul><li><p>&#96;&#96;^((http)s?:&#x2F;&#x2F;)?&#96;</p><ul><li>s 可有可无</li><li>https:&#x2F;&#x2F; 可有可无</li></ul></li><li><p><code>([\\w-]+\\.)+</code> </p><ul><li>可能存在多级域名<ul><li>abc.dc.aaa.com.cn</li></ul></li></ul></li><li><p><code>[a-zA-Z0-9]+</code> </p><ul><li>域名结尾</li></ul></li><li><p><code>((/[\\w-#]+)+\\?([\\w-]+=[\\w-]+&amp;?)*)?$</code></p><ul><li><p><code>(/[\\w-#]+)+</code></p><ul><li>可能存在所层路径<ul><li>&#x2F;video&#x2F;aa&#x2F;bb</li></ul></li></ul></li><li><p><code>\\?</code> </p><ul><li>路径结尾带有参数</li></ul></li><li><p><code>([\\w-]+=[\\w-]+&amp;?)*</code></p><ul><li><code>[\\w-]+</code> 参数名由这些字符组成</li><li><code>=</code> 名与值之间用 &#x3D; 相连</li><li><code>[\\w-]+</code> 参数值由这些字符组成</li><li><code>&amp;?</code> 每对参数之间用 &amp; 相连，若只有一对参数则无需&amp;</li><li><code>*</code> 参数可能有一对或多对</li></ul></li><li><p><code>?$</code> 整个域名后的路径或值都可有可无 并都已存在的元素作为整个URL结尾</p></li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 判断URL是否合法</span><br><span class="hljs-comment">  */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">isUrl</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;https://www.bilibili.com&quot;</span> +<br>            <span class="hljs-string">&quot;/video/BV1Eq4y1E79W?p=17&amp;spm_id_from=pageDriver&quot;</span> +<br>            <span class="hljs-string">&quot;&amp;vd_source=1515d4ece87146a640eebb6175354668&quot;</span>;<br>    <br>    <span class="hljs-type">String</span> <span class="hljs-variable">regex</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^((http)s?://)?([\\w-]+\\.)+[a-zA-Z0-9]+((/[\\w-#]+)+\\?([\\w-]+=[\\w-]+&amp;?)*)?$&quot;</span>;<br>    <br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">isMatch</span> <span class="hljs-operator">=</span> Pattern.matches(regex, url);<br>    <span class="hljs-keyword">if</span> (isMatch) &#123;<br>        System.out.println(<span class="hljs-string">&quot;符合！&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;不符合！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-结巴问题"><a href="#4-结巴问题" class="headerlink" title="4. 结巴问题"></a>4. 结巴问题</h3><blockquote><p>将 ‘’我我我….要要….吃吃吃吃..饭‘’ 变成 ”我要吃饭“</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">spla</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;我我我....要要....吃吃吃吃..饭&quot;</span>;<br>    <br>    <span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;\\.&quot;</span>);<br>    <span class="hljs-type">Matcher</span> <span class="hljs-variable">matcher</span> <span class="hljs-operator">=</span> pattern.matcher(str);<br><span class="hljs-comment">//    将所有 . 替换成 空白</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> matcher.replaceAll(<span class="hljs-string">&quot;&quot;</span>);<br><br>    <span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern1</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;(.)\\1+&quot;</span>);<br>    <span class="hljs-type">Matcher</span> <span class="hljs-variable">matcher1</span> <span class="hljs-operator">=</span> pattern1.matcher(s);<br><span class="hljs-comment">//    使用外部反向引用，$1 表示正则式中的第一个分组捕获的值</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> matcher1.replaceAll(<span class="hljs-string">&quot;$1&quot;</span>);<br>    System.out.println(res);<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5-验证数字规范性"><a href="#5-验证数字规范性" class="headerlink" title="5. 验证数字规范性"></a>5. 验证数字规范性</h3><blockquote><p>识别整数 ， 小数，负数等</p></blockquote><ul><li><code>^[-+]?([1-9]\\d*|0)(\\.\\d+)?$</code><ul><li><code>[-+]?</code><ul><li>数字符号不一定存在</li></ul></li><li><code>([1-9\\d*|0])</code><ul><li>数字以 1 开头 </li><li>或以 0 开头的小数且只能由一个 0</li></ul></li><li><code>(\\.\\d+)?</code><ul><li>数字的小数部分不一定存在</li></ul></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>正则</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
